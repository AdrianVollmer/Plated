{% load i18n %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Test View Server - Plated</title>
        {% load static %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
        <link href="{% static 'styles.css' %}" rel="stylesheet">
        <style>
            body {
                display: flex;
                min-height: 100vh;
                flex-direction: column;
            }
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                bottom: 0;
                width: 280px;
                background-color: var(--bs-secondary-bg);
                border-right: 1px solid var(--bs-border-color);
                overflow-y: auto;
                z-index: 1000;
                padding: 1rem;
            }
            .main-content {
                margin-left: 280px;
                flex-grow: 1;
                padding: 2rem;
            }
            .sidebar-header {
                padding-bottom: 1rem;
                margin-bottom: 1rem;
                border-bottom: 1px solid var(--bs-border-color);
            }
            .sidebar-title {
                font-size: 1.25rem;
                font-weight: 600;
                margin-bottom: 0.5rem;
            }
            .category-title {
                font-size: 0.875rem;
                font-weight: 600;
                text-transform: uppercase;
                color: var(--bs-secondary);
                margin-top: 1rem;
                margin-bottom: 0.5rem;
            }
            .view-link {
                display: block;
                padding: 0.5rem 0.75rem;
                color: var(--bs-body-color);
                text-decoration: none;
                border-radius: 0.375rem;
                margin-bottom: 0.25rem;
                transition: background-color 0.15s ease-in-out;
            }
            .view-link:hover {
                background-color: var(--bs-tertiary-bg);
                color: var(--bs-body-color);
            }
            .view-link.active {
                background-color: var(--bs-primary);
                color: white;
            }
            .theme-toggle-container {
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid var(--bs-border-color);
            }
            @media (max-width: 991px) {
                .sidebar {
                    width: 100%;
                    position: relative;
                }
                .main-content {
                    margin-left: 0;
                }
            }
        </style>
        <script>
            // Apply theme immediately to prevent flash
            (function() {
                const savedTheme = localStorage.getItem('plated-theme') || 'auto';
                let actualTheme = savedTheme;
                if (savedTheme === 'auto') {
                    actualTheme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                }
                document.documentElement.setAttribute('data-theme', actualTheme);
            })();
        </script>
    </head>
    <body>
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">
                    <i class="bi bi-eye"></i> Test View Server
                </div>
                <small class="text-muted">UI/UX Development Tool</small>
            </div>

            {% for category in test_categories %}
                <div class="category-title">{{ category.name }}</div>
                {% for view in category.views %}
                    <a href="{% url view.url %}" class="view-link">
                        {{ view.name }}
                    </a>
                {% endfor %}
            {% endfor %}

            <div class="theme-toggle-container">
                <label class="form-label">
                    <i class="bi bi-palette"></i> Theme
                </label>
                <select id="themeSelector" class="form-select form-select-sm">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="auto">Auto (System)</option>
                </select>
            </div>
        </div>

        <div class="main-content">
            <div class="alert alert-info">
                <h4 class="alert-heading">
                    <i class="bi bi-info-circle"></i> Welcome to the Test View Server
                </h4>
                <p>
                    This tool allows you to preview all views in the application with different data states:
                </p>
                <ul>
                    <li><strong>Empty</strong>: No items in the list</li>
                    <li><strong>1 Item</strong>: Single item for minimal state</li>
                    <li><strong>3 Items</strong>: Few items to test basic layouts</li>
                    <li><strong>30 Items / Many</strong>: Many items to test pagination and scrolling</li>
                </ul>
                <hr>
                <p class="mb-0">
                    <strong>How to use:</strong> Click on any view in the left sidebar to navigate to it.
                    The views use test data created with lorem ipsum content. Toggle between light and dark mode
                    to check visual consistency. Use your browser's back button to return to this index.
                </p>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            // Theme switcher functionality
            const themeSelector = document.getElementById('themeSelector');
            const savedTheme = localStorage.getItem('plated-theme') || 'auto';
            themeSelector.value = savedTheme;

            themeSelector.addEventListener('change', function() {
                const selectedTheme = this.value;
                localStorage.setItem('plated-theme', selectedTheme);

                let actualTheme = selectedTheme;
                if (selectedTheme === 'auto') {
                    actualTheme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                }

                document.documentElement.setAttribute('data-theme', actualTheme);
            });
        </script>
    </body>
</html>
